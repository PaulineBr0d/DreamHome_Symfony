 {%extends 'base.html.twig' %}

{% block title %}Recherche{% endblock %}
   {% block body %}
   <main>

    <h2 class="text-xl font-bold mb-4">Recherche</h2>

    {{ form_start(form, {attr: {class: 'space-y-4'}}) }}
        {{ form_row(form.city) }}
        {{ form_row(form.property_type) }}
        {{ form_row(form.transaction_type) }}
        {{ form_row(form.max_price) }}
        <button type="submit" class="bg-blue-500 text-white px-4 py-2 rounded">Rechercher</button>
    {{ form_end(form) }}

    <section class="container">
            {% if listings is not empty %}
                {% for item in listings %}
                    <div class="item">
                        <img src="{{ asset(item.imageUrl ?? 'uploads/properties/default.webp') }}" alt="Image de l'annonce">
                        <h3>{{ item.title }}</h3>
                        <p><strong>Prix :</strong> {{ item.price|number_format(0, ',', ' ') }} €</p>
                        <p><strong>Ville :</strong> {{ item.city }}</p>
                        <p><strong>Description :</strong> {{ item.description[:120] ~ '…' }}</p>
                        <p><strong>Type de propriété :</strong> {{ item.propertyType.name|e }}</p>
                        <p><strong>Type de transaction :</strong> {{ item.transactionType.name|e }}</p>
                        <a href="{{ path('listing_show', {id: item.id}) }}" class="button-item">Voir l'annonce</a>
                    </div>
                {% endfor %}
            {% else %}
                <p>Aucun résultat trouvé.</p>
            {% endif %}
        </section>
    </main>
{% endblock %}